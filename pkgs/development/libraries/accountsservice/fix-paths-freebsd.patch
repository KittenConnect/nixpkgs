commit 896d08a13eedd72b973c675fa13c3a0c82e96d48
Author: Audrey Dutcher <audrey@rhelmot.io>
Date:   Wed Mar 13 00:48:20 2024 -0700

    fix-paths

diff --git a/src/daemon.c b/src/daemon.c
index 016ba6f..6e1a579 100644
--- a/src/daemon.c
+++ b/src/daemon.c
@@ -1345,7 +1345,7 @@ daemon_create_user_authorized_cb (Daemon                *daemon,
 
         sys_log (context, "create user '%s'", cd->user_name);
 
-        argv[0] = "/usr/sbin/pw";
+        argv[0] = "@pw@/bin/pw";
         argv[1] = "useradd";
         argv[2] = cd->user_name;
         argv[3] = "-m";
@@ -1576,7 +1576,7 @@ daemon_delete_user_authorized_cb (Daemon                *daemon,
         }
         free (resolved_homedir);
 
-        argv[0] = "/usr/sbin/pw";
+        argv[0] = "@pw@/bin/pw";
         argv[1] = "userdel";
         if (ud->remove_files) {
                 argv[2] = pwent->pw_name;
diff --git a/src/user.c b/src/user.c
index fd564f4..dd8129d 100644
--- a/src/user.c
+++ b/src/user.c
@@ -1197,7 +1197,7 @@ user_change_real_name_authorized_cb (Daemon                *daemon,
                         new_gecos = g_strdup (name);
                 }
 
-                argv[0] = "/usr/sbin/pw";
+                argv[0] = "@pw@/bin/pw";
                 argv[1] = "usermod";
                 argv[2] = accounts_user_get_user_name (ACCOUNTS_USER (user));
                 argv[3] = "-c";
@@ -1271,7 +1271,7 @@ user_change_user_name_authorized_cb (Daemon                *daemon,
                          accounts_user_get_uid (ACCOUNTS_USER (user)),
                          name);
 
-                argv[0] = "/usr/sbin/pw";
+                argv[0] = "@pw@/bin/pw";
                 argv[1] = "usermod";
                 argv[2] = accounts_user_get_user_name (ACCOUNTS_USER (user));
                 argv[3] = "-n";
@@ -1722,7 +1722,7 @@ user_set_password_expiration_policy_authorized_cb (Daemon                *daemon
                  accounts_user_get_uid (ACCOUNTS_USER (user)));
 
         g_object_freeze_notify (G_OBJECT (user));
-        argv[0] = "/usr/bin/chage";
+        argv[0] = "@shadow@/bin/chage";
         argv[1] = "-m";
         argv[2] = pwd_expiration->min_days_between_changes;
         argv[3] = "-M";
@@ -1810,7 +1810,7 @@ user_set_user_expiration_policy_authorized_cb (Daemon                *daemon,
         } else {
                 expiration_time = g_strdup ("-1");
         }
-        argv[0] = "/usr/bin/chage";
+        argv[0] = "@shadow@/bin/chage";
         argv[1] = "-E";
         argv[2] = expiration_time;
         argv[3] = accounts_user_get_user_name (ACCOUNTS_USER (user));
@@ -1923,7 +1923,7 @@ user_change_home_dir_authorized_cb (Daemon                *daemon,
                          accounts_user_get_uid (ACCOUNTS_USER (user)),
                          home_dir);
 
-                argv[0] = "/usr/sbin/pw";
+                argv[0] = "@pw@/bin/pw";
                 argv[1] = "usermod";
                 argv[2] = "-n";
                 argv[3] = accounts_user_get_user_name (ACCOUNTS_USER (user));
@@ -1982,7 +1982,7 @@ user_change_shell_authorized_cb (Daemon                *daemon,
                          accounts_user_get_uid (ACCOUNTS_USER (user)),
                          shell);
 
-                argv[0] = "/usr/sbin/pw";
+                argv[0] = "@pw@/bin/pw";
                 argv[1] = "usermod";
                 argv[2] = accounts_user_get_user_name (ACCOUNTS_USER (user));
                 argv[3] = "-s";
@@ -2125,7 +2125,7 @@ user_change_icon_file_authorized_cb (Daemon                *daemon,
                         return;
                 }
 
-                argv[0] = "/bin/cat";
+                argv[0] = "@coreutils@/bin/cat";
                 argv[1] = filename;
                 argv[2] = NULL;
 
@@ -2206,7 +2206,7 @@ user_change_locked_authorized_cb (Daemon                *daemon,
                          locked ? "locking" : "unlocking",
                          accounts_user_get_user_name (ACCOUNTS_USER (user)),
                          accounts_user_get_uid (ACCOUNTS_USER (user)));
-                argv[0] = "/usr/sbin/pw";
+                argv[0] = "@pw@/bin/pw";
                 argv[1] = locked ? "lock" : "unlock";
                 argv[2] = "-n";
                 argv[3] = accounts_user_get_user_name (ACCOUNTS_USER (user));
@@ -2333,7 +2333,7 @@ user_change_account_type_authorized_cb (Daemon                *daemon,
 
                 g_free (groups);
 
-                argv[0] = "/usr/sbin/pw";
+                argv[0] = "@pw@/bin/pw";
                 argv[1] = "usermod";
                 argv[2] = accounts_user_get_user_name (ACCOUNTS_USER (user));
                 argv[3] = "-G";
@@ -2401,7 +2401,7 @@ user_change_password_mode_authorized_cb (Daemon                *daemon,
 
                 if (mode == PASSWORD_MODE_SET_AT_LOGIN ||
                     mode == PASSWORD_MODE_NONE) {
-                        argv[0] = "/usr/bin/passwd";
+                        argv[0] = "/run/wrappers/bin/passwd";
                         argv[1] = accounts_user_get_user_name (ACCOUNTS_USER (user));
                         argv[2] = NULL;
 
@@ -2411,7 +2411,7 @@ user_change_password_mode_authorized_cb (Daemon                *daemon,
                         }
 
                         if (mode == PASSWORD_MODE_SET_AT_LOGIN) {
-                                argv[0] = "/usr/bin/chpass";
+                                argv[0] = "/run/wrappers/bin/chpass";
                                 argv[1] = "-e";
                                 argv[2] = "0";
                                 argv[3] = accounts_user_get_user_name (ACCOUNTS_USER (user));
@@ -2430,7 +2430,7 @@ user_change_password_mode_authorized_cb (Daemon                *daemon,
                          */
                         accounts_user_set_locked (ACCOUNTS_USER (user), FALSE);
                 } else if (accounts_user_get_locked (ACCOUNTS_USER (user))) {
-                        argv[0] = "/usr/sbin/pw";
+                        argv[0] = "@pw@/bin/pw";
                         argv[1] = "unlock";
                         argv[2] = "-n";
                         argv[3] = accounts_user_get_user_name (ACCOUNTS_USER (user));
@@ -2507,7 +2507,7 @@ user_change_password_authorized_cb (Daemon                *daemon,
 
         g_autoptr (GError) error = NULL;
         g_autoptr (GSubprocess) process = NULL;
-        const char *argv[] = { "/usr/bin/passwd", NULL };
+        const char *argv[] = { "/run/wrappers/bin/passwd", NULL };
 
         sys_log (context,
                  "set password and hint of user '%s' (%" G_GUINT64_FORMAT ")",
